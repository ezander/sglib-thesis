function test_pce_mult_stat

stats=get_stats_by_p;
for i=2:6
    fid=fopen(sprintf('comp_mult_by_p_%d.tex',i),'w' );
    fprintf(fid,'%d & %d & %d & %d & %d\\\\\n', stats{i}');
    fclose(fid);
end

stats=get_stats_by_m;
for i=2:6
    fid=fopen(sprintf('comp_mult_by_m_%d.tex',i),'w' );
    fprintf(fid,'%d & %d & %d & %d & %d\\\\\n', stats{i}');
    fclose(fid);
end

% stats=get_stats;
% i=4;
% pol=polyfit( log(stats{i}(:,2)), log(stats{i}(:,4)) , 1 );
% exp(pol(2)+10*pol(1))



plot_nnz_exp_over_p
%plot_nnz_over_m_and_p

function plot_nnz_exp_over_p
stats=get_stats_by_m;
p=[];
kappa=[];
for i=2:length(stats)
%     plot_regression( log(stats{i}(:,2)), log(stats{i}(:,4)), 'r-' ); hold on;
%     plot( log(stats{i}(:,2)), log(stats{i}(:,4)), '-x' ); hold on;
    pol=polyfit( log(stats{i}(:,2)), log(stats{i}(:,4)) , 1 );
    p=[p i];
    kappa=[kappa pol(1)];
end
plot(p,kappa,'o-');


function plot_nnz_over_m_and_p
stats=get_stats;
for i=2:length(get_stats)
%     plot_regression( log(stats{i}(:,2)), log(stats{i}(:,4)), 'r-' ); hold on;
%     plot( log(stats{i}(:,2)), log(stats{i}(:,4)), '-x' ); hold on;
    I=i*ones(size(stats{i}(:,2)));
    plot_regression3( log(stats{i}(:,2)), log(stats{i}(:,4)), I, 'r-' ); hold on;
    plot_blah3( log(stats{i}(:,2)), log(stats{i}(:,4)), I, '-x' ); hold on;
    grid on;
end
hold off

function eval_stats_old( stats, p ) %#ok
p=3;
plot( stats(:,1), stats(:,2), stats(:,1), numsv(stats(:,1),p), 'x' );

plot( log(stats(:,1)), log(stats(:,2)), '-x' ); hold on;
plot_regression( log(stats(4:end,1)), log(stats(4:end,2)), 'rx' ); hold off;

plot( log(stats(:,2)), log(stats(:,3)) ); hold on;
plot_regression( log(stats(:,2)), log(stats(:,3)), 'rx' ); hold off;

plot( log(stats(:,2)), log(stats(:,4)) ); hold on;
plot_regression( log(stats(:,2)), log(stats(:,4)), 'rx' ); hold off;

plot( log(stats(:,2)), log(stats(:,5)) ); hold on;
plot_regression( log(stats(:,2)), log(stats(:,5)), 'rx' ); hold off;

function M=numsv(m,p)
M=factorial(m+p)./(factorial(m).*factorial(p));

function stats=get_stats_by_p
stats{2}=[
1     3         27         11   2
2     6        216         36   6
3    10       1000         82  12
4    15       3375        155  22
5    21       9261        261  35
6    28      21952        406  54
7    36      46656        596  78
8    45      91125        837 109
9    55     166375       1135 147
10    66     287496       1496 192
11    78     474552       1926 246
12    91     753571       2431 310
13   105    1157625       3017 384
14   120    1728000       3690 468
15   136    2515456       4456 565
16   153    3581577       5321 673
17   171    5000211       6291 795
18   190    6859000       7372 930
19   210    9261000       8570 1081
20   231   12326391       9891 1246
21   253   16194277      11341 1428
22   276   21024576      12926 1627
23   300   27000000      14652 1843
24   325   34328125      16525 2077
25   351   43243551      18551 2331
26   378   54010152      20736 2605
27   406   66923416      23086 2899
28   435   82312875      25607 3214
29   465  100544625      28305 3552
30   496  122023936      31186 3913
];
stats{3}=[
1     4         64         23   3
2    10       1000        120   8
3    20       8000        382  21
4    35      42875        935  46
5    56     175616       1941  90
6    84     592704       3598 165
7   120    1728000       6140 281
8   165    4492125       9837 457
9   220   10648000      14995 710
10   286   23393656      21956 1065
11   364   48228544      31098 1551
12   455   94196375      42835 2199
];
stats{4}=[
1     5        125         42   3
2    15       3375        339  10
3    35      42875       1525  28
4    70     343000       4980  69
5   126    2000376      13251 151
6   210    9261000      30562 303
7   330   35937000      63414 567
8   495  121287375     121275 1000
];
stats{5}=[
1     6        216         69   3
2    21       9261        801  12
3    56     175616       4783  37
4   126    2000376      19668 102
5   252   16003008      63504 252
6   462   98611128     172942 570
];
stats{6}=[
1     7        343        106   3
2    28      21952       1723  13
3    84     592704      13592  44
4   210    9261000      70952 131
5   462   98611128     282464 349
];
stats{7}=[
1     8        512        154   3
2    36      46656       3361  14
3   120    1728000      33752  51
4   330   35937000     215960 166
];
stats{8}=[
1     9        729        215   3
2    45      91125       6174  15
3   165    4492125      78338  57
4   495  121287375     614995 197
];
stats{9}=[
1    10       1000        290   3
2    55     166375      10662  16
3   220   10648000     166775  64
];
stats{10}=[
1    11       1331        381   3
2    66     287496      17661  16
3   286   23393656     338054  69
];
stats{11}=[
1    12       1728        489   4
2    78     474552      28035  17
3   364   48228544     645242  75
];
stats{12}=[
1    13       2197        616   4
2    91     753571      43162  17
3   455   94196375    1186584  79
];
stats{13}=[
1    14       2744        763   4
2   105    1157625      64414  18
];
stats{14}=[
1    15       3375        932   4
2   120    1728000      93906  18
];
stats{15}=[
1    16       4096       1124   4
2   136    2515456     133686  19
];
stats{16}=[
1    17       4913       1341   4
2   153    3581577     186831  19
];
stats{17}=[
1    18       5832       1584   4
2   171    5000211     256257  20
];
stats{18}=[
1    19       6859       1855   4
2   190    6859000     346258  20
];
stats{19}=[
1    20       8000       2155   4
2   210    9261000     460834  20
];
stats{20}=[
1    21       9261       2486   4
2   231   12326391     605781  20
];

function stats=get_stats_by_m
stats{2}=[
1     3         27          7   4
2     6        216         36   6
3    10       1000        120   8
4    15       3375        339  10
5    21       9261        801  12
6    28      21952       1723  13
7    36      46656       3361  14
8    45      91125       6174  15
9    55     166375      10662  16
10    66     287496      17661  16
11    78     474552      28035  17
12    91     753571      43162  17
13   105    1157625      64414  18
14   120    1728000      93906  18
15   136    2515456     133686  19
16   153    3581577     186831  19
17   171    5000211     256257  20
18   190    6859000     346258  20
19   210    9261000     460834  20
20   231   12326391     605781  20
21   253   16194277     786423  21
22   276   21024576    1010373  21
23   300   27000000    1284543  21
24   325   34328125    1618708  21
25   351   43243551    2021656  21
26   378   54010152    2505699  22
27   406   66923416    3081813  22
28   435   82312875    3765252  22
29   465  100544625    4569516  22
30   496  122023936    5513236  22
];
stats{3}=[
1     4         64         10   6
2    10       1000         82  12
3    20       8000        382  21
4    35      42875       1525  28
5    56     175616       4783  37
6    84     592704      13592  44
7   120    1728000      33752  51
8   165    4492125      78338  57
9   220   10648000     166775  64
10   286   23393656     338054  69
11   364   48228544     645242  75
12   455   94196375    1186584  79
];
stats{4}=[
1     5        125         13  10
2    15       3375        155  22
3    35      42875        935  46
4    70     343000       4980  69
5   126    2000376      19668 102
6   210    9261000      70952 131
7   330   35937000     215960 166
8   495  121287375     614995 197
];
stats{5}=[
1     6        216         16  14
2    21       9261        261  35
3    56     175616       1941  90
4   126    2000376      13251 151
5   252   16003008      63504 252
6   462   98611128     282464 349
];
stats{6}=[
1     7        343         19  18
2    28      21952        406  54
3    84     592704       3598 165
4   210    9261000      30562 303
5   462   98611128     172942 570
];
stats{7}=[
1     8        512         22  23
2    36      46656        596  78
3   120    1728000       6140 281
4   330   35937000      63414 567
];
stats{8}=[
1     9        729         25  29
2    45      91125        837 109
3   165    4492125       9837 457
4   495  121287375     121275 1000
];
stats{9}=[
1    10       1000         28  36
2    55     166375       1135 147
3   220   10648000      14995 710
];
stats{10}=[
1    11       1331         31  43
2    66     287496       1496 192
3   286   23393656      21956 1065
];
stats{11}=[
1    12       1728         34  51
2    78     474552       1926 246
3   364   48228544      31098 1551
];
stats{12}=[
1    13       2197         37  59
2    91     753571       2431 310
3   455   94196375      42835 2199
];
stats{13}=[
1    14       2744         40  69
2   105    1157625       3017 384
];
stats{14}=[
1    15       3375         43  78
2   120    1728000       3690 468
];
stats{15}=[
1    16       4096         46  89
2   136    2515456       4456 565
];
stats{16}=[
1    17       4913         49 100
2   153    3581577       5321 673
];
stats{17}=[
1    18       5832         52 112
2   171    5000211       6291 795
];
stats{18}=[
1    19       6859         55 125
2   190    6859000       7372 930
];
stats{19}=[
1    20       8000         58 138
2   210    9261000       8570 1081
];
stats{20}=[
1    21       9261         61 152
2   231   12326391       9891 1246
];

function plot_regression( x, y, varargin )

p=polyfit( x, y , 1 );
X=linspace(min(x), max(x), 20);
plot( X, p(2)+p(1)*X, varargin{:} );

function plot_regression3( x, y, z, varargin )
p=polyfit( x, y , 1 );
disp( [p] );
%X=linspace(min(x), max(x), 20);
X=x;
if isscalar(z); z=z*ones(size(X)); end;
%plot3( X, p(2)+p(1)*X, z , varargin{:} );
plot3( X, z, p(2)+p(1)*X, varargin{:} );

function plot_blah3( x, y, z, varargin )
plot3( x, z, y , varargin{:} );


